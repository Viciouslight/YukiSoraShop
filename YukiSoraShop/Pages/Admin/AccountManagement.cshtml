@page
@model YukiSoraShop.Pages.Admin.AccountManagementModel
@{
    ViewData["Title"] = "Account Management";
    Layout = "~/Pages/Shared/_AdminLayout.cshtml";
}

<div class="page-title">
    Account Management
</div>

@if (!string.IsNullOrEmpty(Model.Message))
{
    <div class="alert alert-@Model.MessageType">
        <i class="fas fa-@(Model.MessageType == "success" ? "check-circle" : "exclamation-circle")"></i>
        @Model.Message
    </div>
}

<div class="table-container">
    <div class="card-header mb-4">
        <h5><i class="fas fa-users text-primary"></i> Danh sách Người dùng</h5>
    </div>

    @if (Model.Users.Any())
    {
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Email / Username</th>
                    <th>Họ Tên</th>
                    <th>Số điện thoại</th>
                    <th>Trạng thái</th>
                    <th>Ngày tạo</th>
                    <th>Thao tác</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model.Users)
                {
                    <tr>
                        <td>@user.Id</td>
                        <td>
                            <strong>@user.Email</strong><br />
                            <small class="text-muted">(@user.Username)</small>
                        </td>
                        <td>@(string.IsNullOrEmpty(user.FullName) ? "N/A" : user.FullName)</td>
                        <td>@(string.IsNullOrEmpty(user.PhoneNumber) ? "N/A" : user.PhoneNumber)</td>
                        <td>
                            <span class="badge bg-success">Active</span>
                        </td>
                        <td>@user.CreatedAt.ToString("dd/MM/yyyy")</td>
                        <td>
                            <form method="post" asp-page-handler="Delete" asp-route-id="@user.Id" style="display: inline;">
                                <button type="submit" class="btn btn-sm btn-danger" 
                                        onclick="return confirm('Bạn có chắc chắn muốn xóa mềm tài khoản của @user.FullName (ID: @user.Id) không?')">
                                    <i class="fas fa-trash"></i> Xóa
                                </button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <div class="empty-state">
            <i class="fas fa-users"></i>
            <h4>Không tìm thấy tài khoản nào</h4>
            <p>Hiện tại chưa có tài khoản nào trong hệ thống.</p>
        </div>
    }
</div>

@section Scripts {
    <script>
        // Auto-hide alert after 5 seconds
        setTimeout(function() {
            var alerts = document.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                var fadeOut = setInterval(function() {
                    if (!alert.style.opacity) {
                        alert.style.opacity = 1;
                    }
                    if (alert.style.opacity > 0) {
                        alert.style.opacity -= 0.1;
                    } else {
                        clearInterval(fadeOut);
                        alert.style.display = 'none';
                    }
                }, 50);
            });
        }, 5000);
    </script>
}
