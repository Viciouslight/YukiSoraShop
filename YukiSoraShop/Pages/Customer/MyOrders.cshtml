@page
@model YukiSoraShop.Pages.Customer.CustomerOrdersModel
@{
    ViewData["Title"] = "Đơn hàng của tôi - YukiSoraShop";
    Layout = null; // Full layout style để đồng bộ với Home & Cart
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@ViewData["Title"]</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600&display=swap" rel="stylesheet" />
</head>

<body style="font-family: 'Inter', sans-serif; background-color: #f8f9fc;">

    <!-- ===== HEADER ===== -->
    <header class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top py-3">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary fs-4" href="/" style="font-family: 'Poppins', sans-serif;">
                <i class="fas fa-bolt me-2 text-warning"></i>YukiSora<span class="text-dark">Shop</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="mainNav">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0 fw-semibold">
                    <li class="nav-item"><a class="nav-link text-dark px-3" href="/">Trang chủ</a></li>
                    <li class="nav-item"><a class="nav-link text-dark px-3" href="/Customer/Catalog">Sản phẩm</a></li>
                    <li class="nav-item"><a class="nav-link text-dark px-3" href="/Support">Hỗ trợ</a></li>
                </ul>
            </div>
        </div>
    </header>

    <!-- ===== HERO ===== -->
    <section class="py-5 text-center text-white bg-gradient-primary">
        <div class="container py-4">
            <h1 class="fw-bold mb-2" style="font-family: 'Poppins', sans-serif;">Đơn hàng của tôi</h1>
            <p class="lead text-light">Xem lại lịch sử mua sắm và tình trạng xử lý đơn hàng của bạn.</p>
        </div>
    </section>

    <!-- ===== ORDER LIST ===== -->
    <section class="container my-5">
        @if (!Model.Orders.Any())
        {
            <div class="text-center py-5">
                <i class="fas fa-box-open fa-4x text-primary mb-3"></i>
                <h4 class="fw-bold text-dark mb-2">Bạn chưa có đơn hàng nào</h4>
                <p class="text-muted mb-4">Khám phá sản phẩm và mua sắm ngay hôm nay!</p>
                <a href="/Customer/Catalog" class="btn btn-primary px-4 py-2 fw-semibold">
                    <i class="fas fa-store me-2"></i> Mua sắm ngay
                </a>
            </div>
        }
        else
        {
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <div class="table-responsive">
                    <table class="table align-middle">
                        <thead class="bg-light">
                            <tr>
                                <th>ID</th>
                                <th>Ngày tạo</th>
                                <th>Trạng thái</th>
                                <th class="text-end">Tạm tính (VND)</th>
                                <th class="text-end">Vận chuyển</th>
                                <th class="text-end">Tổng cộng</th>
                                <th>Thanh toán</th>
                                <th>Hóa đơn</th>
                                <th class="text-end">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var o in Model.Orders)
                            {
                                <tr class="hover-row">
                                    <td class="fw-bold text-primary">#@o.OrderId</td>
                                    <td>@o.CreatedAt.ToLocalTime().ToString("dd/MM/yyyy HH:mm")</td>
                                    <td>
                                        <span class="badge rounded-pill px-3 py-2 @o.StatusBadgeClass">@o.StatusDisplay</span>
                                    </td>
                                    <td class="text-end">@o.Subtotal.ToString("N0")</td>
                                    <td class="text-end">@o.ShippingFee.ToString("N0")</td>
                                    <td class="text-end fw-bold text-primary">@o.GrandTotal.ToString("N0")</td>
                                    <td>
                                        <span class="badge bg-opacity-75 @o.PaymentStatusClass">
                                            <i class="@o.PaymentStatusIcon me-1"></i>@o.PaymentStatusDisplay
                                        </span>
                                    </td>
                                    <td>
                                        @if (o.InvoiceCount > 0)
                                        {
                                            <span class="badge bg-info">@o.InvoiceCount</span>
                                        }
                                        else
                                        {
                                            <span class="text-muted">0</span>
                                        }
                                    </td>
                                    <td class="text-end">
                                        @if (o.ShowPayButton)
                                        {
                                            <a class="btn btn-sm btn-gradient" href="/Orders/PaymentMethod?OrderId=@o.OrderId">
                                                <i class="fas fa-credit-card"></i> Thanh toán
                                            </a>
                                        }
                                        else if (string.Equals(o.Status, "AwaitingCash", StringComparison.OrdinalIgnoreCase))
                                        {
                                            <a class="btn btn-sm btn-outline-warning" href="/Orders/CashConfirmation?OrderId=@o.OrderId">
                                                <i class="fas fa-money-bill"></i> Chi tiết tiền mặt
                                            </a>
                                        }
                                        else
                                        {
                                            <a class="btn btn-sm btn-outline-secondary" href="/Orders/Detail?OrderId=@o.OrderId">
                                                <i class="fas fa-eye"></i> Xem chi tiết
                                            </a>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        }
    </section>

    <!-- ===== FOOTER ===== -->
    <footer class="bg-dark text-light pt-5 pb-3 mt-5">
        <div class="container text-center">
            <p class="small mb-2">© 2025 YukiSora Technology. All Rights Reserved.</p>
            <div class="d-flex justify-content-center gap-3">
                <a href="#" class="text-light text-decoration-none">Chính sách bảo mật</a>
                <a href="#" class="text-light text-decoration-none">Điều khoản sử dụng</a>
                <a href="#" class="text-light text-decoration-none">Hỗ trợ</a>
            </div>
        </div>
    </footer>

    <style>
        .bg-gradient-primary {
            background: linear-gradient(135deg, #0d47a1, #1976d2, #42a5f5);
        }

        .card {
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .table th {
            font-weight: 600;
            color: #374151;
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        .table td {
            vertical-align: middle;
            font-size: 0.95rem;
        }

        .hover-row {
            transition: all 0.2s ease-in-out;
        }

            .hover-row:hover {
                background-color: #eef5ff;
            }

        .btn-gradient {
            background: linear-gradient(135deg, #0d47a1, #1976d2);
            color: #fff;
            border: none;
            transition: all 0.3s ease;
        }

            .btn-gradient:hover {
                background: linear-gradient(135deg, #1565c0, #2196f3);
                color: #fff;
            }

        .badge {
            font-weight: 500;
        }

        .text-primary {
            color: #1565c0 !important;
        }

        .bg-info {
            background-color: #42a5f5 !important;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
